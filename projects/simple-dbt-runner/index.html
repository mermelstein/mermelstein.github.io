<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://danielmermelstein.com/projects/simple-dbt-runner/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Simple dbt Runner - Daniel Mermelstein</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Daniel Mermelstein</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Projects</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../downwinder/" class="dropdown-item">Downwinder Forecast</a>
</li>
                                    
<li>
    <a href="../nyc3k/" class="dropdown-item">NYC 3K Finder</a>
</li>
                                    
<li>
    <a href="../snowquery/" class="dropdown-item">Snowquery</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Simple dbt Runner</a>
</li>
                                    
<li>
    <a href="../haggadah_translation/" class="dropdown-item">Haggadah Translation</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../snowquery/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../haggadah_translation/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#project-simple-dbt-runner-self-host-dbt-with-github-actions" class="nav-link">Project: Simple dbt Runner - Self-Host dbt with GitHub Actions</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#our-solution-open-source-dbt-runners" class="nav-link">Our Solution: Open-Source dbt Runners</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#how-it-works" class="nav-link">How It Works</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#impact-and-goals" class="nav-link">Impact and Goals</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#technical-stack" class="nav-link">Technical Stack</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#project-links-status" class="nav-link">Project Links &amp; Status</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="project-simple-dbt-runner-self-host-dbt-with-github-actions">Project: Simple dbt Runner - Self-Host dbt with GitHub Actions</h1>
<p>The "Simple dbt Runner" is an open-source project I spearheaded to provide a cost-effective and flexible alternative for running dbt (data build tool) in production. This was a response to changes in dbt Cloud's pricing, which for my organization and many others would have resulted in cost increases of many multiples. The basics of the price change were from a cost per seat to usage costs based on time of each DAG run.</p>
<p>The primary function of dbt Cloud at the time was just scheduling. There were a couple other features but nothing major, and we were happy to pay a small monthly fee to not have to think about it. the moment it became a real cost center we decided to cut it.</p>
<h2 id="our-solution-open-source-dbt-runners">Our Solution: Open-Source dbt Runners</h2>
<p>The Github repo offers a suite of pre-configured GitHub Actions workflows that allow teams to manage their dbt runs, CI/CD processes, and documentation hosting directly within the GitHub ecosystem. For most teams it would probably run in the free tier (Github Actions charges by runtime but the free tier threshold is reasonable).</p>
<p>Key capabilities include:</p>
<ul>
<li><strong>Scheduled Production Runs:</strong> Execute dbt jobs on a cron schedule.</li>
<li><strong>Merge-Triggered Runs:</strong><ul>
<li><strong>Full Runs:</strong> Execute all dbt models after a PR is merged to the main branch.</li>
<li><strong>State-Aware Incremental Runs:</strong> Intelligently run only modified models and their downstream dependencies, using a <code>manifest.json</code> stored in a <code>gh-pages</code> branch for state comparison.</li>
</ul>
</li>
<li><strong>Continuous Integration (CI):</strong> Run dbt builds and tests on every commit to a pull request to ensure changes are valid before merging.</li>
<li><strong>dbt Documentation Hosting:</strong> Automatically generate and deploy dbt documentation to GitHub Pages, also utilizing the <code>gh-pages</code> branch. We started off with the assumption that users would want to host documentation privately and we selected AWS S3, but decided it was an additional complexity for this project. Large enough companies have Github Enterprise and are able to host documentation privately via Github Pages.</li>
</ul>
<h2 id="how-it-works">How It Works</h2>
<p>The core idea is to provide a "plug-and-play" setup:</p>
<ol>
<li><strong>Fork &amp; Configure:</strong> Teams fork the repository and place their dbt project into a designated folder.</li>
<li><strong>Secrets Management:</strong> Database credentials and a GitHub Personal Access Token (for workflow permissions) are stored as GitHub Actions secrets.</li>
<li><strong>Automated Setup:</strong> A "Project Setup" workflow assists in configuring <code>profiles.yml</code> and <code>requirements.txt</code> for the target database.</li>
<li><strong>Workflow Customization:</strong> Users can select, modify, or delete the provided GitHub Action workflow files (<code>.yml</code>) to suit their specific needs.</li>
</ol>
<p>The state-aware incremental runs are a key feature, minimizing computation by only processing what's changed. This is achieved by comparing the current dbt project state against the <code>manifest.json</code> from the previous successful production run.</p>
<h2 id="impact-and-goals">Impact and Goals</h2>
<ul>
<li>Reduced dbt costs at my organization by over 95% compared to dbt Cloud.</li>
<li>Provided a robust, free, and open-source alternative to paid dbt orchestration services.</li>
<li>Gave data teams full control over their dbt deployment environment and schedule.</li>
<li>Simplified the process of setting up CI/CD for dbt projects.</li>
</ul>
<h2 id="technical-stack">Technical Stack</h2>
<ul>
<li><strong>dbt (data build tool)</strong></li>
<li><strong>GitHub Actions</strong> (for orchestration and CI/CD)</li>
<li><strong>Python</strong> (for dbt execution and utility scripts)</li>
<li><strong>YAML</strong> (for GitHub Actions workflow definitions)</li>
<li><strong>Shell scripting</strong> (for helper utilities)</li>
</ul>
<h2 id="project-links-status">Project Links &amp; Status</h2>
<ul>
<li><strong>Status:</strong> Active, open-source.</li>
<li><strong>GitHub Repository:</strong> <a href="https://github.com/C00ldudeNoonan/simple-dbt-runner" target="_blank" rel="noopener noreferrer">simple-dbt-runner</a></li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
